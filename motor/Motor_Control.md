推荐书籍

> 乌曼《电机学》
>
> 谭建成《永磁无刷直流电机技术》
>
> 叶金虎《现代无刷直流永磁电动机的原理和设计》
>
> 胡寿松《自动控制原理》
>
> 《电机和电源控制中的最新微控制器技术》
>
> 

# 1. 电机分类

## 1.1 直流电机

- 直流有刷电机
- 直流有刷减速电机
- 直流无刷电机
- 直流无刷减速电机

**”减速“：**构造上多一个减速齿轮组，普通的直流电机当空载时，电机的转速由电压决定; 直流减速电机的转速由齿轮组和电压决定。齿轮组的作用是，提供较低的转速，较大的力矩；同时不同的减速比会提供不同的转速和力矩。这样就大大提高了减速电机的使用率

**有刷与无刷：**有无碳刷，有刷电机电机工作时需要线圈和换向器旋转，磁钢和碳刷不转，线圈电流方向的交替变化是随电机转动的换相器和电刷来完成的。无刷直流电动机是采用半导体开关器件来实现电子换向的，使用电子开关器件代替传统的接触式换向器和电刷

## 1.2 步进电机

步进电机是一种可以将脉冲信号转换为角位移或线位移的开环控制电机，在空载低频的情况下，一个脉冲就是一步，可以精准的控制旋转角度;

| 构造方式 | 特性                                                         |
| -------- | ------------------------------------------------------------ |
| 反应式   | 结构简单、成本低、步距角小，可达 1.2°、但动态性能差、效率低、发热大，可靠性难保证。 |
| 永磁式   | 其特点是动态性能好、输出力矩大，但这种电机精度差，步矩角大（一般为 7.5° 或 15°）。 |
| 混合式   | 其特点是输出力矩大、动态性能好，步距角小，但结构复杂、成本相对较高 |

两相混合式步进电机

**42 步进电机：**42 步进电机是指步进的尺寸，混合式步进电机一般都是正方形，外框尺寸为 42mm*42mm

## 1.3 伺服电机

绝对服从控制信号指挥电机，所以伺服电机是指在伺服系统中被控制的电机如果单指一个电机的话，那只能算一个被控的机械元件，但是加上**闭环控制系统就可以称之为伺服系统中的电机**

伺服电机分为直流和交流伺服电动机两大类，其主要特点是，当信号电压为零时无自转现象，转速随着转矩的增加而匀速下降。

**直流伺服电机特性：**

1. 机械特性在输入的电枢电压保持不变时，电机的转速随电磁转矩变化而变化的规律
2. 调节特性直流电机在一定的电磁转矩（或负载转矩）下电机的稳态转速随电枢的控制电压变化而变化
3. 动态特性从原来的稳定状态到新的稳定状态，存在一个过渡过程，这就是直流电机的动态特性

**交流伺服电机特性**

1. 无电刷和换向器，因此工作可靠，对维护和保养要求低
2. 定子绕组散热比较方便
3. 惯量小，易于提高系统的快速性
4. 适应于高速大力矩工作状态

## 1.4 舵机

舵机是一种常见的伺服电机，由小型直流电机、控制电路板、电位计和齿轮组构成

**按照信号类型划分为模拟信号舵机和数字信号舵机**

- 模拟舵机：无 MCU 微控制器，电路为模拟电路，同样的舵机之间会有性能差异
- 数字舵机：有 MCU 控制器，一般内部采用算法优化，性能比模拟舵机好

**齿轮划分为金属齿轮舵机和塑料齿轮舵机：**

- 金属齿轮舵机：适用于大扭力和高速场合
- 塑料齿轮舵机：成本低适用于中低扭矩场合

# 2.驱动器分类

## 2.1 有刷电机驱动器

H 桥电路进行驱动，核心电路 H 桥加上一些必要的外围电路，共同组成直流有刷电机的驱动器

**集成电路形式的 H 桥**一般用于中小功率需求的应用，或者是对电路面积有要求的场合。

**分立元件形式的 H 桥**通常用于大功率或者超大功率需求的应用，主要由 MOSFET 或 IGBT 晶体管组成。

经典的直流有刷电机驱动芯片 L298N，其内部集成了两个 H 桥

## 2.2 无刷电机驱动器

无刷电机也是使用 H 桥电路进行驱动的，只不过是**电机的每一相都用一个半桥电路驱动**，一个三相无刷电机总共需要三个半桥，而不像直流有刷电机驱动那种使用全桥电路

## 2.3 步进电机驱动器

控制器将**步进脉冲和方向信号发送到步进电机驱动器**，驱动器将控制器发来的步进脉冲信号转换为激励步进电动机旋转所需的功率信号

## 2.4 伺服电机驱动器

用来驱动和控制伺服电机的控制器属于伺服系统的一部分，伺服电机驱动器接收和放大来自控制系统的命令信号，并将电流传输给伺服电机，以产生与命令信号成比例的运动。命令信号通常对伺服电机的位置、速度和力矩等参数进行控制，实现高精度的传动系统定位

# 3.直流有刷电机

## 3.1 直流有刷电机工作原理

左手定则：F=BILsinα

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-101817.png) 

磁极方向的跳转是通过移动固定位置的接触点来完成的，该接触点在电机转子上与电触点相对连接。这种**固定触点**通常由**石墨**制成，与铜或其他金属相比，在**大电流短路或断路/起动过程中石墨不会熔断或者与旋转触点焊接到一起**，并且这个触点通常是弹簧承载的，所以能够获得持续的接触压力，保证向线圈供应电力。

-  C 和 D 两片半圆周的铜片构成换向器
- 两个弹性铜片靠在换向器两侧的 A 和 B 是电刷

## 3.2 直流有刷减速电机重要参数

- 空载转速：正常工作电压下电机不带任何负载的转速（单位为 r/min（转/分））
  - 空载转速由于没有反向力矩，所以输出功率和堵转情况不一样，该参数只是提供一个电机在规定电压下最大转速的参考
- 空载电流：正常工作电压下电机不带任何负载的工作电流（单位 mA（毫安））。
  - 越好的电机，在空载时，该值越小。
- 负载转速：正常工作电压下电机带负载的转速
- 负载力矩：正常工作电压下电机带负载的力矩（N·m（牛米））
- 负载电流：负载电流是指电机拖动负载时实际检测到的定子电流数值。
- 堵转力矩：在电机受反向外力使其停止转动时的力矩。
  - 如果电机堵转现象经常出现，则会损坏电机，或烧坏驱动芯片
  - 堵转时间一长，电机温度上升的很快，这个值也会下降的很厉害
- 堵转电流：在电机受反向外力使其停止转动时的电流，此时电流非常大，时间稍微就可能会烧毁电机
- 减速比：是指没有减速齿轮时转速与有减速齿轮时转速之比。
- 功率：般指的是它的额定功率（单位 W（瓦）），即在额定电压下能够长期正常运转的最大功率
  - 电动机在制造厂所规定的额定情况下运行时, 其输出端的机械功率

## 3.3 **直流有刷电机驱动**

### 3.3.1 **控制电路原理**

![H桥电路](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-102931.png) 

- Q1，Q4导通电机顺时针旋转
- Q3，Q2导通电机逆时针旋转
- 当同一侧的 Q1 和 Q2 【  或者Q3 和Q4】同时导通时，电流将从电源先后经过 Q1 和 Q2【Q3 和Q4】，然后直接流到电源负极在这个回路中除了三极管以外就没有其他负载（没有经过电机），这时电流可能会达到最大值，此时可能会烧毁三极管

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-103406.png) 

改进电路中新增加了两个非门和 4 个与门，以及 Q1 和 Q3 换成了 NPN 三极管，经过这样的组合就可以实现一个信号控制两个同一侧的三极管，并且可以保证在同一侧中两个三级管不会同时导通在同一时刻只会有一个三极管是导通的。

- ENABLE 脚接入高电平
- IN1高电平：【Q1截至 Q2导通】  IN2高电平【Q3截至 Q4导通】电机停转
- IN1高电平：【Q1截至 Q2导通】  IN2低电平【Q3导通 Q4截至】电机逆时针旋转
- IN1低电平：【Q1导通 Q2截至】  IN2高电平【Q3截至 Q4导通】电机顺时针旋转
- IN1低电平：【Q1导通 Q2截至】  IN2低电平【Q3导通 Q4截至】电机停转

### 3.3.2 驱动芯片

H 桥使用分立元件搭建比较麻烦，增加了硬件设计难度，当然如果集成 IC 无法满足我们的功率要求时，还是需要我们自己使用 MOS管、三极管等元件来搭建 H 桥电路，这样的分立元件搭建的 H 桥一般驱动能力都会比集成 IC 要高。当我们在选择集成 IC 时，我们需要考虑集成 IC 是否能满足电机的驱动电压要求，是否能承受电机工作时的电流

**L298N** **驱动芯片**

L298N 是 ST 公司的产品，内部包含 4 通道逻辑驱动电路，是一种二相和四相电机的专门驱动芯片，即内含两个 H 桥的高电压大电流双桥式驱动器，接收标准的 TTL 逻辑电平信号，可驱动4.5V~46V、2A 以下的电机，电流峰值输出可达 3A

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-104327.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-104723.png) 

## 3.4 直流有刷减速电机控制

### 3.4.1 速度控制

脉冲宽度调制（Pulse width modulation，PWM）信号，即 PWM 是一种按一定的规则对各脉冲的宽度进行调制，既可改变电路输出电压的大小，也可改变输出频率。

V=Vmax * Duty(占空比)

### 3.4.2 硬件设计

#### 3.4.2.1 L298N

驱动板可以支持 12-42V 的宽电压供电，并且带输入电压转 5V 的电压芯片，所以驱动板只需要一个电源输入

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-110020.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-110053.png) 

两个二极管是作为钳位使用，使得输出线上电压（或叫电位）被箝位在-0.7V~+Vcc+0.7V

#### 3.4.2.2 直流有刷电机驱动板-MOS管搭建板

驱动板可支持 12V~70V 的宽电压输入，10A 过电流保护电路，超过 10A 可自动禁用电机控制信号，最高功率支持 700W。PWM 控制信号使用了 TLP2362 高速光耦进行了隔离，SD 控制信号使用了 EL357N 光耦进行了隔离

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-111730.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-111818.png) 

EG2104S 主要功能有逻辑信号输入处理、死区时间控制、电平转换功能、悬浮自举电源结构和上下桥图腾柱式输出。逻辑信号输入端高电平阀值为 2.5V 以上，低电平阀值为 1.0V 以下，要求逻辑信号的输出电流小，可以使 MCU 输出逻辑信号直接连接到 EG2104S 的输入通道上。

芯片有一个 shutdown 引脚，逻辑输入控制信号低电平有效，控制强行使 LO、HO 输出低电平。这样可以直接使用这个引脚做软件控制电机的旋转与停止，还可以实现硬件的限流保护

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-111927.png) 

#### 3.4.3 软件设计

| EN   | PWM1 | PWM2 | 电机状态 |
| ---- | ---- | ---- | -------- |
| 0    | x    | x    | 停止     |
| 1    | 100% | 100% | 停止     |
| 1    | x%   | 0    | 正转     |
| 1    | 0    | x%   | 反转     |

## 3.5 **直流有刷驱动板电流电压采集**

### 3.5.1 电流采样电路

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-113331.png) 

在下图中使用电压比较器 LMV331SE 实现 10A 过流保护电路，电流采样电路中 Vi 经过隔离运放和普通运放后变成 Vcurrent_adc 输入到下图比较器的 IN-，当 IN-的电压超过 IN+ 时，比较器的 OUT将输出低电平到 74HC1G66GW（模拟开关）的 Y 端口和左下端的 NPN 型 MOS 管中。当 OUT 将输出低电平时，NPN-MOS 截止，此时 3V3 电压会供给 74HC1G66GW，让其使能，这样模拟开关就会闭合，74HC1G66GW 的 Y 端口与 Z 端口相当于连接在一起，低电平信号从 Z 端口，输出到下一级锁存器 SN74LVC1G373DBVR，锁存器对输入信号进行锁存并输出到与门。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-113547.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-113847.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-113926.png) 

### 3.5.2 电源电压采样电路

如下图所示是电源电压采样电路，在电源电压上并联 R18 和 R19、R59 的串联电阻，R19两端的电压作为隔离运放的输入，再经过隔离器件后差分输出，使用普通运放将差分输出转换成单端输出，连接到 STM32 的 ADC 采样通道。隔离运放的输入电压为 Vi，则有:Vi/R19=POWER/(R18+R59+R19)，带入电阻值可得：Vi=POWER/37，通过上一节中电流采样电流的计算方法可以计算得到 POWER_ADC=POWER/37+1.24，不同的是，电压检测部分的隔离器件是没有进行放大的。

# ![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-114210.png)4.无刷直流电机

无刷直流电机（Brushless Direct Current Motor，简称 BLDCM）由电动机主体和驱动器组成，是一种典型的机电一体化产品。

无刷电机是指无电刷和换向器（或集电环）的电机，又称无换向器电机。子交换，即无刷电机中使用电枢绕组作为定子，使用钕铁硼的永磁材料作为转子，以霍尔传感器取代碳刷换向器

## 4.1 无刷电机重要参数

- **额定电压**：无刷电机适合的工作电压，其实无刷电机适合的工作电压非常广，额定电压是指定了负载条件而得出的情况
  - 2212-850KV 电机指定了 1045 螺旋桨的负载，其额定工作电压就是 11V。如果减小负载，例如带 7040 螺旋桨，那这个电机完全可以工作在 22V 电压下
  - 工作电压也不是无限上升的，主要受制于电子控制器支持的最高频率
- **KV值**：有刷直流电机是根据额定工作电压来标注额定转速的，实际转速 =KV 值 * 工作电压，KV 的物理意义，就是在 1V 工作电压下每分钟的转速
  - 无刷直流电机的转速与电压呈正比关系，电机的转速会随着电压上升而线性上升
- **转矩与转速：**
  - 转矩:(力矩、扭矩）电机中转子产生的可以用来带动机械负载的驱动力矩，我们可以理解为电机的力量。
  - 转速: 电机每分钟的转速。
  - 电机的转矩和转速在同一个电机内永远是一个此消彼长的关系，基本可以认为转矩和转速的乘积是一个定数，即同一个电机的转速越高，必定其转矩越低，相反也依然。
- **最大电流和最大功率**
  - 最大电流: 电机能够承受并安全工作的最大电流
  - 每个电机都有自己的力量上限，最大功率就是这个上限，如果工作情况超过了这个最大功率，就会导致电机高温烧毁。
- **槽极结构（N:槽数 P极数）**
  - 铁芯极数（槽数)∶ 定子硅钢片的槽数量
  - 磁钢极数（极数)∶ 转子上磁钢的数量
    - 模型常见的内转子无刷电机结构有: 3N2P(有感电机常用)、12N4P(大部分内转子电机)
    - 模型常见的外转子无刷电机结构有:9N6P、9N12P、12N8P、12N10P、12N14P、18N16P、24N20P
    - 模型用内转子无刷电机极数不高的原因: 目前内转子电机多用于减速使用，所以要求的转速都比较高。电子转速 = 实际转速 * 电机极对数，电子控制器支持的最高电子转速往往都是一个定数，所以如果电机极对数太高的话，支持的最高电机转速就会下降，所以目前的内转子电机极数都是4 以内。
- **其他设计驱动需要的参数**
  - 定子电感：电动机静止时的定子绕组两端的电感。
  - 定子电阻：在 20℃ 下电动机每相绕组的直流电阻。
  - 反电动势系数：在规定条件下，电动机绕组开路时，单位转速在电枢绕组中所产生的线感应电动势值。

## 4.2 无刷直流电机工作原理

安培定则：右手螺旋定则

用右手握住通电直导线，让大拇指指向电流的方向，那么四指指向就是磁感线的环绕方向；

用右手握住通电螺线管，让四指指向电流的方向，那么大拇指所指的那一端是通电螺线管的 N 极，

### **4.2.1 三相星形联结的二二导通方式**

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-145252.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-145327.png) 

1. 在 A 端接入正电压，B 端接入负电压，C 端悬空，转子将会旋转至图中 1 的位置。
2. 在 1 的基础上，C 端接入正电压，B 端接入负电压，A 端悬空，转子将会从 1 的位置旋转至图中 2 的位置。
3. 在 2 的基础上，C 端接入正电压，A 端接入负电压，B 端悬空，转子将会从 2 的位置旋转至图中 3 的位置。
4. 在 3 的基础上，B 端接入正电压，A 端接入负电压，C 端悬空，转子将会从 3 的位置旋转至图中 4 的位置。
5.  在 4 的基础上，B 端接入正电压，C 端接入负电压，A 端悬空，转子将会从 4 的位置旋转至图中 5 的位置。
6. 在 5 的基础上，A 端接入正电压，C 端接入负电压，B 端悬空，转子将会从 5 的位置旋转至图中 6 的位置。

## 4.3 直流无刷电机驱动设计

**做三相六臂全桥驱动电路来驱动无刷电机**

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-145602.png) 

6 拍工作方式

- Q1Q4,Q5Q4,Q5Q2,Q3Q2,Q3Q6,Q1Q6

想让一对 MOS 管导通时，是需要知道上一步导通的是哪两个 MOS,所以这里我们需要知道转子的位置信息



![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/Hall_effect.gif) 

霍尔传感器是根据霍尔效应制作的一种磁场传感器。霍尔效应：当电流垂直于外磁场通过半导体时，载流子发生偏转，垂直于电流和磁场的方向会产生一附加电场，从而在半导体的两端产生电势差，这一现象就是霍尔效应，这个电势差也被称为霍尔电势差。

在 BLDC 中一般采用 3 个开关型霍尔传感器测量转子的位置，由其输出的 3 位二进制编码去控制三相六臂全桥中的 6 个 MOS 管的导通实现换相。

- 如果将一只霍尔传感器安装在靠近转子的位置，当 N 极逐渐靠近霍尔传感器即磁感器达到一定值时，其输出是导通状态；
- 当 N 极逐渐离开霍尔传感器、磁感应逐渐小时，其输出仍然保持导通状态；
- 只有磁场转变为 S 极便达到一定值时，其输出才翻转为截止状态。
- 在 S 和 N 交替变化下传感器输出波形占高、低电平各占 50%
- 如果转子是一对极，则电机旋转一周霍尔传感器输出一个周期的电压波形，如果转子是两对极，则输出两个周期的波形。

在直流无刷电机中一般把 3 个霍尔传感器按间隔 120 度或 60 度的圆周分布来安装，如果按间隔120 度来安装，则 3 个霍尔传感器输出波形相差 120 度电度角，输出信号中高、低电平各占 180度电度角。如果规定输出信号高电平用“1”表示，低电平用“0”表示，则输出的三个信号可以用三位二进制码表示，如下图所示。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-150852.png) 



![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-151017.png) 

对 MOS 管的控制有中两个特殊情况需要注意一下:

- 当按真值表中对应霍尔值导通 MOS 管后，就保持导通状态不变时，此时电机就会旋转到对应位置保持不变，此时电路中的电能将只能转换为热能，不能转换为机械能，而我们的电机绕组时候的是漆包铜线，其内阻非常的小，电流就会非常的大，这将会产生大量的热而导致电源或者电机被烧毁。
- 在上面的三相六臂全桥驱动电路原理图中如果同时导通 Q1 和 Q2，或者导通 Q3 和 Q4，或者导通 Q5 和 Q6，只要导通以上对应的两个 MOS 管，都会导致电路中的电机不能正常工作，而 MOS 管直接将电源的正负极接通，这无疑将会烧毁电源或者 MOS 管。

### 4.3.1 **驱动芯片与驱动电机设计**

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-151321.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-151607.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-151647.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-151716.png) 

IR2110S 主要功能有逻辑信号输入处理、电平转换功能和悬浮自举电源结构等。可以使 MCU 输出逻辑信号直接连接到 IR2110S 的输入通道上。IR2110S 芯片有一个 shutdown 引脚，逻辑输入控制信号高电平有效，控制强行使 LO、HO 输出低电平。这样可以直接使用这个引脚做软件控制电机的旋转与停止，还可以实现硬件的限流保护（后续章节分析保护电路），输入信号和输出信号逻辑真值表如下表所示。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-151816.png) 

## 4.4 无刷直流电机控制实现

### 4.4.1 速度控制原理

转速计算公式：V=(Ua-IaRa)/CEφ

• Ua——电机定子绕组的实际电压大小

• Ia——电机绕组内通过的实际电流大小

• Ra——电路系统中包含电机的回路电阻大小

• CE——电势系数

• φ——励磁磁通

我们可以对无刷直流电机的**供电电压**所处适当调整，从而降低线圈绕组通过电流大小，以期达到控制电机转速的目的，同前面讲到的直流有刷减速电机一样，直流无刷电机也可以使用脉宽调制信号（PWM）来进行速度控制，通常使用的 PWM 频率为十几或者几十千赫兹（不得超过 MOS 管的开关频率），这样把需要通电的MOS 管使用 PWM 来控制就可以实现速度的控制。

使用 PWM 控制直流无刷电机的策略包括 PWM-ON、ON-PWM、H_PWM-L_ON、H_ON-L_PWM和 H_PWM-L_PWM。这 5 种控制策略，均是电机处于 120° 运行方式下进行的

**这 5 种调制方式为：**

- \1. PWM-ON 型。在 120° 导通区间，各开关管前 60° 采用 PWM 调制，后 60° 则恒通。

- \2. ON-PWM 型。在 120° 导通区间，各开关管前 60° 恒通，后 60° 则采用 PWM 调制。

- \3. H_PWM-L_ON 型。在 120° 导通区间，上桥臂开关管采用 PWM 调制，下桥臂恒通。

- \4. H_ON-L_PWM 型。在 120° 导通区间，上桥臂开关管恒通，下桥臂采用 PWM 调制。

- \5. H_PWM-L_PWM 型。在 120° 导通区间，上、下桥臂均采用 PWM 调制。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-154340.png) 

# 5.编码器

编码器，是一种用来测量机械旋转或位移的传感器。这种传感器能够测量机械部件在旋转或直线运动时的位移位置或速度等信息，并将其转换成一系列电信号。

## 5.1分类

### 5.1.1 增量式编码器

增量式旋转编码器是将设备运动时的位移信息变成连续的脉冲信号，脉冲个数表示位移量的大小。只有当设备运动的时候增量式编码器才会输出信号。编码器一般会把这些信号分为通道 A和通道 B 两组输出，并且这两组信号间有 90° 的相位差。同时采集这两组信号就可以知道设备的运动和方向。除了通道 A、通道 B 以外，很多增量式编码器还会设置一个额外的通道 Z 输出信号，用来表示编码器特定的参考位置，传感器转一圈 Z 轴信号才会输出一个脉冲。增量式编码器只输出设备的位置变化和运动方向，不会输出设备的绝对位置。

### 5.1.2 绝对式编码器

绝对式旋转编码器是将设备运动时的位移信息通过二进制编码的方式变成数字量直接输出。这种编码器与增量式编码器的区别主要在内部的码盘。绝对式编码器的码盘利用若干透光和不透光的线槽组成一套二进制编码，这些二进制码与编码器转轴的每一个不同角度是唯一对应的，读取这些二进制码就能知道设备的绝对位置，所以叫它绝对式编码器。绝对式编码器一般常用自然二进制、格雷码或者 BCD 码等编码方式。

### 5.1.3 混合式绝对式编码器

混合式绝对式编码器，它输出两组信息：一组信息用于检测磁极位置，带有绝对信息功能；另一组则和增量式编码器的输出信息完全相同。

## 5.2 旋转编码器原理

旋转编码器的原理示意图如下图所示。旋转编码器内部大都由码盘、光电检测装置和信号处理电路等部分构成。码盘上刻了若干圈线槽，线槽等距并且可透光，当码盘旋转时就会周期性的透过和遮挡来自光电检测装置的光线，这样检测装置就会周期性的生成若干电信号。

### 5.2.1 增量式编码器原理

增量式编码器都有 A、B 两通道信号输出，这是因为增量式编码器的码盘上有两圈线槽，两圈线槽的之间会错开一定的角度，这个角度会使得光电检测装置输出的两相信号相差 1/4 周期 (90°)。

当码盘转动时，内圈和外圈的线槽会依次透过光线，光电检测装置检测到光线通断的变化，就会相应的输出脉冲信号，因为内外圈遮光和透光时候存在时间差，所以也就有了 A、B 两通道信号的相位差。

### 5.2.2 绝对式编码器原理

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-164009.png) 

## 5.3 编码器参数

- 分辨率：指编码器能够分辨的最小单位
  - 对于增量式编码器，其分辨率表示为编码器转轴旋转一圈所产生的脉冲数，即脉冲数/转 (Pulse Per Revolution 或 PPR)。码盘上透光线槽的数目其实就等于分辨率，也叫多少线，较为常见的有 5-6000 线。
  - 绝对式编码器，内部码盘所用的位数就是它的分辨率，单位是位 (bit)，具体还分单圈分辨率和多圈分辨率
- 精度：精度是指编码器每个读数与转轴实际位置间的最大误差，通常用角度、角分或角秒来表示。
  - 有些绝对式编码器参数表里会写 ±20′′，这个就表示编码器输出的读数与转轴实际位置之间存在正负 20 角秒的误差，精度由码盘刻线加工精度、转轴同心度、材料的温度特性、电路的响应时间等各方面因素共同决定。
- 最大响应频率：指编码器每秒输出的脉冲数，单位是 Hz。计算公式：最大响应频率 = 分辨率 * 轴转速/60。
- 信号输出形式：对于增量式编码器，每个通道的信号独立输出，输出电路形式通常有集电极开路输出、推挽输出、差分输出等。对于绝对式编码器，由于是直接输出几十位的二进制数，为了确保传输速率和信号质量，一般采用串行输出或总线型输出，例如同步串行接口 (SSI)、RS485、CANopen 或 EtherCAT 等，也有一部分是并行输出，输出电路形式与增量式编码器相同。

## 5.4 编码器使用

### 5.4.1 **增量式编码器倍频技术**

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-140042.png) 

### 5.4.2 常见测速方法

常用的编码器测速方法。对于电机转速的测量，可以把增量式编码器安装到电机上，用控制器对编码器脉冲进行计数，然后通过特定的方法求出电机转速，常用的编码器测速方法一般有三种：M 法、T 法和 M/T 法

- M法：又叫做频率测量法。这种方法是在一个固定的定时时间内（以秒为单位），统计这段时间的编码器脉冲数，计算速度值。
  - 设编码器单圈总脉冲数为 C（单位：脉冲数/转），在时间 T0 内，统计到的编码器脉冲数为 M0，则转速 n 的计算公式为 ：n = M0/CT
  - 公式中的编码器单圈总脉冲数 C 是常数，所以转速 n 跟 M0 成正比。这就使得在高速测量时 M0变大，可以获得较好的测量精度和平稳性，但是如果速度很低，低到每个 T0 内只有少数几个脉冲，此时算出的速度误差就会比较大，并且很不稳定。
  - 改善 M 法在低速测量的准确性，上一节提到的增量式编码器倍频技术就是其中一种，比如原本捕获到的脉冲 M0 只有4 个，经过 4 倍频后，相同电机状态 M0 变成了 16 个，也就提升了低速下的测量精度
- T法：又叫做周期测量法，建立一个已知频率的高频脉冲并对其计数，计数时间由捕获到的编码器相邻两个脉冲的间隔时间 TE 决定，计数值为 M1。
  - 设编码器单圈总脉冲数为 C，高频脉冲的频率为 F0，则转速 n 的计算公式为：n= 1/CTe=F0/CM1
  - 编码器单圈总脉冲数 C 和高频脉冲频率 F0 是常数，所以转速 n 跟 M1 成反比。从公式可以看出，在电机高转速的时候，编码器脉冲间隔时间 TE 很小，使得测量周期内的高频脉冲计数值 M1 也变得很少，导致测量误差变大，而在低转速时，TE 足够大，测量周期内的 M1 也足够多，所以 T 法和 M 法刚好相反，更适合测量低速。
- M/T 法：这种方法综合了 M 法和 T 法各自的优势，既测量编码器脉冲数又测量一定时间内的高频脉冲数。
  - 在一个相对固定的时间内，计数编码器脉冲数 M0，并计数一个已知频率为F0 的高频脉冲，计数值为 M1，计算速度值。设编码器单圈总脉冲数为 C，则转速 n 的计算公式为：n=F0M0/CM1
  - 由于 M/T 法公式中的 F0 和 C 是常数，所以转速 n 就只受 M0 和 M1 的影响。电机高速时，M0 增大，M1 减小，相当于 M 法，低速时，M1 增大，M0 减小，相当于 T 法。



# 6.控制系统与电机的关系

## 6.1 什么是控制系统

控制系统是指由控制主体，控制客体和控制媒体组成的具有自身目标和功能的管理系统。

为了使控制对象达到预期的稳定状态。例如一个水箱的温度控制，可以通过控制加热设备输出功率进而来改变水温达到目标温度，水箱的温度控制可以称之位一个简单的控制系统

## 6.2 自动控制系统的工作原理

对生产中某些关键参数进行自动控制，使它们在受到外界干扰的影响而偏离正常状态时能够被自动地调节而回到工艺所要求的数值范围。

### 6.2.1 闭环自动控制系统

闭环控制也就是负反馈控制，系统组成包括传感器，控制装置，执行机构。传感器检测被控对象的状态信息（输出量），并将其转变为物理（电）信息传给控制装置。控制装置比较被控对象当前状态（输出量）对希望状态（给定量）的偏差，产生一个控制信号，通过执行器机构驱动被空对象运动，使其运动状态接近希望状态。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-175216.png)

### 6.2.2 开环自动控制系统

开环控制不能检测误差，不能够校正误差，之恶能够按照事先确定好的程序和产生信号的条件，依次去控制对象并且无抑制的干扰能力

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-175526.png) 

## 6.3 控制系统与电机由上面关系

在控制系统中有一个角色十分重要，他根据控制装置的信号改变着被控对象的状态--执行器。执行器的种类多种多样，可以使改变温度的电阻丝，改变转速的电机，只要是符合可以改变被控对象的状态多可以称之为执行器，

说电机加上相应的传输结构占执行器的一大部分，所以说控制电机就变成了十分重要的内容。电机控制的好坏直接决定于被控对象状态改变的是否准确。电机的控制是对电机的启动、加速、运转、减速以及停止进行控制，通过对其控制达到快速启动、快速响应、高效率、高扭矩输出和高过载能力的目的。



# 7.PID

## 7.1 PID简介

PID 是 Proportional（比例）、Integral（积分）、Differential（微分）的首字母缩写；是一种结合比例、积分和微分三种环节于一体的闭环控制算法，它是目前为止在连续控制系统中计数最为成熟的一种控制算法；

PID 控制的实质是对目标值和实际值误差进行比例、积分、微分运算后的结果用来作用在输出上。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-113603.png) 

### 7.1.1 比例（ Proportional）

Kp*e(t):比例控制器的输出与输入成正比关系，能够迅速的反应偏差，偏差减小的速度取决于比例系数 Kp,Kp 越大偏差减小的就越快，但是极易引起震荡；Kp 减小发生震荡的可能性减小，但是调节的速度变慢，单纯的比例控制存在不能消除的静态误差，这里就需要积分来控制。

### 7.1.2 积分（Integral）

在积分环节中，主要用于就是**消除静态误差提高系统的无差度**。积分作用的强弱，取决于积分时间常数 Ti，Ti 越大积分作用越弱，反之则越强。积分控制作用的存在与偏差 e(t) 的存在时间有关，只要系统存在着偏差，积分环节就会不断起作用，对输入偏差进行积分，使控制器的输出及执行器的开度不断变化，产生控制作用以减小偏差。在积分时间足够的情况下，可以完全消除静差，这时积分控制作用将维持不变。Ti 越小，积分速度越快，积分作用越强。积分作用太强会使系统超调加大，甚至使系统出现振荡。

### 7.1.3 微分（Differential）

微分环节的作用是反应系统偏差的一个变化趋势，也可以说是变化率，可以在误差来临之前提前引入一个有效的修正信号，有利于提高输出响应的快速性, 减小被控量的超调和增加系统的稳定性。

微分环节有助于系统减小超调，克服振荡，加快系统的响应速度，减小调节时间，从而改善了系统的动态性能，但微分时间常数过大，会使系统出现不稳定。微分控制作用一个很大的缺陷是容易引入高频噪声，所有在干扰信号比较严重的流量控制系统中不宜引入微分控制作用。



## 7.2 PID算法离散化

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-114707.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-114835.png) 

采样的时间间隔为T，kT时刻：

- err(k) = target - reality(k)
- 积分和 = err(T) + err(2T) + ... + err(kT)
- kT时刻误差变化率 = (err(k)-err(k-1))/T

### 7.2.1 位置式PID离散形式：

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-115409.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-115453.png) 

- k为采样的序号
- err(k)为第k次的误差
- u(k)为输出量
- Kp
- Ki=Kp*T/Ti
- Kd=Kp*Td/T

### 7.2.2 增量式PID离散形式

△u=u(k)-u(k-1)

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-120006.png) 

# 8.直流电机速度环控制

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-114707.png) 

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230221-175216.png)

目标：电机已设定的目标速度运行

速度反馈：M法：固定的定时时间，统计这段时间的编码器脉冲数，计算速度值，计数方向，反应电机正反转方向

控制装置：周期调用PID控制，根据反馈的实际速度，进行 PID 计算，输出PWM 占空比

执行机构：通过PID计数输出的PWM 占空比

被控对象：电机

# 9.直流电机电流环控制实现

希望以恒定的电流来驱动电机运转，即希望电机能输出恒定的转矩

目标：电机已设定目标电流运行

电流反馈：电流 ACD 采样结果（DMA/滤波）

控制装置：周期调用PID控制，根据反馈的实际电流，进行 PID 计算，输出PWM 占空比

执行机构：通过PID计数输出的PWM 占空比

被控对象：电机

# 10.直流电机位置环控制实现

位置控制模式一般是通过编码器产生的脉冲的个数来确定转动的角度或者是转的圈数，由于位置模式可以位置进行严格的控制，所以一般应用于定位装置。

目标：电机运行到指定位置

位置反馈：编码器产生的脉冲的个数

控制装置：周期调用PID控制，根据反馈的实际位置，进行 PID 计算，输出PWM 占空比

执行机构：通过PID计数输出的PWM 占空比

被控对象：电机

# 11.有刷电机多环控制

在整个控制闭环内，速度环的后级，再串上一个电流环，以前级的输出 (这里指速度环的输出)，作为后级的输入(这里指作为电流环的输入)，最终后级 (电流环) 的输出最终实现在执行机构上, 以形成双反馈控制的效果。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230222-152346.png) 

在串级 PID 控制中，**最外环一般选择期望控制的参数的环节**，例如对应速度快慢的速度环、位置的位置环、电流大小的电流环大小，需要我们从内环到外环依次的调参；

定时器调用的不同周期中 ，计算了各环的PID 参数，内环控制的周期要比外环周期短，因为内环控制着最终的输出，这个输出对应的就是实际场景中的控制量

在实际应用中，还是根据实际的场景设定内外环控制周期。控制的最终效果，还是要让内环跟随外环的变化趋势最终达到稳定效果。

速度环和电流环[稳定*电机*力矩]的输入参数进行限制，预防超调的情况发生

```
1.设定目标速度
2.pid_control loop : 100ms
	get_curr_val()
	timer++;
	motor_en:
		get_speed()
		if timer%2==0
			cont_val = speed_pid()
			/* 电流上下限 */
			set_cuur_target(cont_val)
		endif
		val = curr_pid()
		/*PWM上下限处理*/
		set_pwm(val)
endlood
```



对于直流电动机来讲，电流环的主要作用是可以快速给定扭矩，另一个角度，是可以在一定程度上加快负载扭矩扰动带来的处理，因为负载扭矩忽然变化对电枢电流的影响是最直接最快的，在电流环节做闭环处理，响应速度上快于负载扭矩变化->角加速度变化->角速度变化, 然后再闭环。

<<<<<<< HEAD
# 12.舵机

## 12.1 舵机分类

- 按照舵机的控制电路可以分为：模拟舵机和数字舵机
  - 模拟舵机和数字舵机的机械结构可以说是完全相同的，模拟舵机的控制电路为纯模拟电路，需要一直发送目标信号，才能转到指定的位置，响应速度较慢，无反应区较大；数字舵机内部控制电路则加上了微控制器，只需要发送一次目标信号，即可到达指定位置，速度比模拟舵机更快，无反应区也更小
- 按照使用对象的不同，可以分为：航模舵机、车模舵机、船模舵机和机器人舵机。
- 按照内部机械材质，又可分成：塑料齿舵机和金属齿舵机。
- 外部接口和舵机的控制方式，又可分为：PWM 舵机和串行总线舵机

## 12.2 模拟舵机工作原理

模拟舵机内部的控制驱动电路板从外界接收控制信号，经过处理后变为一个直流偏置电压，在控制板内部有一个基准电压，这个基准电压由电位器产生并反馈到控制板。将外部获得的直流偏置电压与电位器的电压进行比较获得电压差，并输出到电机驱动芯片驱动电机，电压差的正负决定电机的正反转，大小决定旋转的角度，电压差为 0 时，电机停止转动。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230223-101330.png) 

直流偏置电压是指晶体管放大电路中使晶体管处于放大状态时，基极-射极之间及集电极-基极之间应该设置的电压

## 12.3 舵机控制原理

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230223-101654.png) 

中脉冲宽度与舵机旋转角度为线性关系，其他舵机控制脉冲也类似，0.5ms 对应 0 度，2.5ms对应最大旋转角度，脉冲宽度与旋转角度也是线性关系

## 12.4 舵机参数

- 舵机速度的单位是 sec/60°，就是舵机转过 60° 需要的时间
  - 如果控制脉冲变化宽度大，变化速度快，舵机就有可能在一次脉冲的变化过程中还没有转到目标角度时，而脉冲就再次发生了变化，舵机的转动速度一般有 0.16sec/60°、0.12sec/60° 等，0.16sec/60° 就是舵机转动 60° 需要 0.16 秒的时间。
  - 舵机的速度还有工作电压有关，在允许的电压范围内，电压越大速度越快，反之亦然。
- 舵机扭矩的单位是 KG*CM，这是一个扭矩的单位，可以理解为在舵盘上距离舵机轴中心水平距离 1CM 处，舵机能够带动的物体重量
  - ![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/screenshot-20230223-102529.png) 



# 13.步进电机

步进电机又称为脉冲电机，基于最基本的电磁铁原理，它是一种可以自由回转的电磁铁，其动作原理是依靠气隙磁导的变化来产生电磁转矩。

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/20210513174921347.gif) 

## 13.1 按照定子相数进行分类

> https://blog.csdn.net/mahoon411/article/details/116753402?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167711793916800211551841%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167711793916800211551841&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116753402-null-null.142^v73^insert_down2,201^v4^add_ask,239^v2^insert_chatgpt&utm_term=%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA&spm=1018.2226.3001.4187

### 13.1.1 单相步进电机

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/2021051320292358.png) 

单相步进电机的电磁转矩只在定子电流变换时产生，其平均转矩比两相以上的电机小得多，响应脉冲频率也在100pps(pulse per second)以下，故其用途受到很大限制，只能在响应脉冲频率比较低的轻载下运行。例如时钟、车用计时器、水表计数器。

### 13.1.2 两相步进电机

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/2021051321124456.png) 

定子磁极数为4极，相当于一个绕组占两个极。

### 13.1.3 三相步进电机

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/2021051321170333.png) 

三相步进电机定子线圈的主极数为三的倍数，故三相步进电机的定子主极数为3、6、9、12

### 13.1.4 四相步进电机

四相步进电机的驱动器结构复杂，成本高，只有特殊用途才使用。

### 13.1.5 五相步进电机

![](https://raw.githubusercontent.com/QLiwei/picgo/main/img/20210513212636437.png)



## 13.2 按照转子结构进行分类

### 13.2.1 永磁式步进电机(Permanent Magnet,PM)

转子由永磁材料构成。PM型转子为内转子型，圆柱形转子的外表面分布N、S极(外表面无齿)。

### 13.2.2 反应式步进电机(Variable Reluctance，VR)

转子由硅钢片或电工纯铁棒等导磁体构成，转子外表面为多齿结构(转子的齿槽在转动时产生磁阻变化，故又称为变磁阻电机)。当定子线圈通电时，定子磁极磁化，吸引转子齿而产生转矩，使其移动一步。

与永磁电机产生磁性吸引转矩和排斥转矩相比，反应式步进电机只产生吸引转矩。



=======
>>>>>>> b8d30acbfa9fa436360c75dff59aa91d9aa75d9c
# 附录

## 附录1 电机堵转

### 电机堵转的表现有哪些

电机堵转是电机在转速为0转时仍然输出扭矩的一种情况，一般都是机械的或者人为的。由于电机负载过大、拖动的机械故障、轴承损坏扫堂等原因引起的电动机无法启动或停止转动的现象。电机堵转时功率因数极低，堵转时的电流（称堵转电流）最高可达额定电流的7倍，时间稍长就会烧坏电机。因此，电机的一般性试验就包括堵转试验这一项。

电机转动时，定子绕组形成的旋转磁场拖动转子旋转，而转子中感应电流所产生的磁场也在定子绕组感应出反电势，也就是我们说的感抗，起到阻止电机定子电流增加的作用。

### 电机堵转电流为什么会增大

电机堵转时电流变大的原因是：

电机转动时，定子绕组形成的旋转磁场拖动转子旋转，而转子中感应电流所产生的磁场也在定子绕组感应出反电动势，这是消耗电压的主要部分。

电机堵转时反电势为零，电机只有其自身的电阻和电感，所有电压都加载在绕组上。自然电流会大大增加。根据电机容量的大小和加工工艺不同，电机堵转电流一般为电机额定电流的50-12倍。



## 附录2

### 1.伺服电机

伺服电机在闭环系统中运行，该系统包括反馈装置、驱动器（放大器）和控制器。控制器使用反馈装置的输出将指令值（位置、速度或扭矩）与达到的值进行比较，并向驱动器发出指令以纠正任何错误。监控反馈和进行纠正的过程称为控制回路，即为环。根据应用和性能要求，伺服系统可以包括三种控制回路的任意组合：位置回路、速度回路和/或电流回路。
伺服驱动器通常具有多回路结构，电流回路嵌套在速度回路中，速度回路嵌套在位置回路中。

### 2.速度环

速度环是最常见的[伺服控制环](https://www.zhihu.com/search?q=伺服控制环&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})。它通过转速表或[编码器](https://www.zhihu.com/search?q=编码器&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})将指令速度与实际速度进行比较，并相应地发出增加或降低电机速度的指令。速度回路也称为PI控制器，因为它通常使用比例增益（Kvp）和积分增益（Kvi）来确定校正命令。顾名思义，比例增益的大小与误差的大小成正比，而[积分增益](https://www.zhihu.com/search?q=积分增益&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})随着时间的推移而增加，用于在运动结束时将电机“推”到零误差。[伺服反馈](https://www.zhihu.com/search?q=伺服反馈&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})增益，即比例增益Kp、积分增益Ki和微分增益Kd，决定了伺服试图纠正或减少指令值和实际值之间的误差的程度。

### 3.位置环

对于需要位置控制的应用，在所谓的级联位置/速度回路中，在速度回路的“周围”添加位置回路。位置回路确定[跟随误差](https://www.zhihu.com/search?q=跟随误差&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})，即实际位置和指令位置之间的偏差，并发出速度指令以减少或消除跟随误差。在[级联系统](https://www.zhihu.com/search?q=级联系统&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})中，位置回路通常只使用比例增益Kp。
伺服系统可以使用位置回路而不使用速度回路，尽管[速度反馈](https://www.zhihu.com/search?q=速度反馈&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})提供了额外的刚度，并对抗[高频干扰](https://www.zhihu.com/search?q=高频干扰&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})。如果单独使用位置回路，而没有速度回路，则位置回路将为[PID控制器](https://www.zhihu.com/search?q=PID控制器&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})。比例、积分和微分三种增益的使用虽然更复杂，但允许系统调整到最佳性能。

### 4.电流环

当所需的**响应时间很高**时，需要[电流控制](https://www.zhihu.com/search?q=电流控制&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"article"%2C"sourceId"%3A"556054521"})，如许多工业伺服应用中的情况。**电流回路的主要目标是控制转矩，转矩会影响速度，从而影响位置**。电流环通常嵌套在速度环内，使电流成为最内层的回路，中间的速度环，位置环是最外环。电流回路通常是PI控制器，具有比例增益和积分增益。电流控制参数通常由制造商设置，从而节省用户调整电流控制回路的时间和精力。

### 5.带宽

在任何级联系统中，内环的响应时间或带宽必须快于外环的响应时间。否则，内环对外环几乎没有影响。嵌套伺服控制回路的一般规则是，速度回路的带宽应为位置回路的5到10倍，当前回路的带宽应为速度回路的5到10倍。
一般来说，带宽越高越好，但由于一个环路的带宽会影响其中的下一个环路，因此增加位置环路的带宽会导致速度环路所需的带宽增加。同样，增加速度回路的带宽会导致当前回路所需的带宽增加。在这两种情况下，将一个循环的带宽增加到下一个嵌套循环所需的带宽无法实现的程度，对系统的性能没有好处。

<<<<<<< HEAD
## 附录3 步进电机和无刷电机的区别

步进电机走的是很小很小的小碎步，最高速度有限，所以能够精确；
而无刷电机则是大步大步的飞奔，而且涉及就是为了高速飞奔提供动力的，所以想精确的停下来是不可能的。

再就是工作方式不同，设计的阻抗也不同：
步进电机基本上是工作在堵转模式的，也就是说很多事时候是停下来不动的（定位），而且这是绕组也还是照样通着电的；
而无刷电机，绕组的阻抗一般都很小很小（几十~几百毫欧），设计电流也很大，停下来的时候当然就不能通电了，不然非得冒烟不可.

解步进电机不需要位置反馈，而无刷直流电机需要位置反馈

合适的换相速度让步进+合适的驱动电流拉齿+合适的小电流让卡住 反正这些东西最后都是些时序 俺玩过，发热严重，磁钢都有一定退磁温度。。。  这个时候无刷是不检测位置的。反过来，LZ可以自己试试把步进倒过来看看能当无刷体验下不。。。 动手做才有对比。 他们工作时候都是利用错齿然后磁力去拉动。 无刷内阻很小，20多V可以跑到100多A，拳头大的电机可以远超过2KW--如果轴承承受的了。 步进内阻想想都要很大，不然电流N大了。长期的通电又不动。
无刷是为了高效率高转速，步进是为了高精度。高效率高转速自然要检测位置，在恰当时候换相。步进根本工作在堵转，效率很低狂发热，没有流畅的一拍接一拍换相----要检测位置，怎么也不可能快起来。
=======
>>>>>>> b8d30acbfa9fa436360c75dff59aa91d9aa75d9c
